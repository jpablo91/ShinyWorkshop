<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Lab Ib: Inputs and Outputs</title>

<script src="site_libs/header-attrs-2.14/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/cosmo.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.11.4/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>
<link href="site_libs/font-awesome-5.1.0/css/all.css" rel="stylesheet" />
<link href="site_libs/font-awesome-5.1.0/css/v4-shims.css" rel="stylesheet" />

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark it active
  menuAnchor.tab('show');

  // if it's got a parent navbar menu mark it active as well
  menuAnchor.closest('li.dropdown').addClass('active');

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "&#xe258;";
  border: none;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html"><img id="logo" style="width: 30px;" src="img/logo-nb.png" /></a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Pre Workshop
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="0a_R_Intro.html">Prerequsites</a>
    </li>
    <li>
      <a href="0b_Intro_to_R.html">Intro to R</a>
    </li>
    <li>
      <a href="0c_Spatial_intro.html">Intro to Spatial data</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Contact
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="Instructors.html">
        <span class="fa fa-users"></span>
         
        Instructor
      </a>
    </li>
    <li>
      <a href="https://cadms.vetmed.ucdavis.edu">
        <span class="fa fa-server"></span>
         
        CADMS Website
      </a>
    </li>
    <li>
      <a href="mailto:jpgo@ucdavis.edu">
        <span class="fa fa-envelope"></span>
         
        Email
      </a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Lab Ib: Inputs and Outputs</h1>

</div>


<div id="introduction" class="section level1" number="1">
<h1><span class="header-section-number">1</span> Introduction</h1>
<p>In this lab we will start a shiny app from scratch and develop it to generate a few interactive figures.</p>
<p>Objectives:</p>
<ul>
<li>Load our own data into the app.<br />
</li>
<li>Generate Inputs and Outputs.<br />
</li>
<li>Create interactive visualizations.</li>
</ul>
<hr />
<p>We will start loading some libraries we will be using:</p>
<pre class="r"><code># Load the ibraries
library(shiny)
library(dplyr) # For data manipulation
library(ggplot2) # For creating the figures</code></pre>
<p>The data we will be using is contained in the STNet library, you can access to the data using::</p>
<pre class="r"><code># Make sure you have installed the most recent verison of STNet:
# devtools::install_github(&#39;jpablo91/STNet&#39;)
library(STNet) # Load the library 
data(&quot;vac&quot;) # get the data</code></pre>
<p>If you have a look in your environment, you will see that the dataset is available there now, you can get examine the first observations:</p>
<pre class="r"><code>head(vac)</code></pre>
<pre><code>##   CVE_MUN   CVE_LOC  NOM_MUN      LONG      LAT YEAR TOTAL_HATOS TOTAL_BOV
## 1   15105 151050284 Tlatlaya -100.2739 18.37306 2007           0         0
## 2   15105 151050261 Tlatlaya -100.3033 18.38111 2007           4        36
## 3   15105 151050042 Tlatlaya -100.2933 18.38361 2007          41      1040
## 4   15105 151050045 Tlatlaya -100.2881 18.38417 2007          47      1632
## 5   15105 151050086 Tlatlaya -100.3111 18.39083 2007          21       287
## 6   15105 151050074 Tlatlaya -100.3106 18.39917 2007          88      3663
##   VAC_BOV HATOS_VAC
## 1       0         0
## 2       0         0
## 3      90         2
## 4       0         0
## 5      60         1
## 6    2260        13</code></pre>
<p>The library <code>shiny</code> provides several functions to create our app. The main function is <code>shinyApp</code>, which will ask for two arguments: <code>ui</code> and <code>server</code>. In this lab we will create two objects that contains all the necessary to be used as arguments for the <code>shinyApp()</code> function.</p>
</div>
<div id="user-interface-ui" class="section level1" number="2">
<h1><span class="header-section-number">2</span> User interface (UI)</h1>
<p>The user interface (UI) is where we will define the type of input and outputs that our app will have, as well as any relevant information for the user.</p>
<p>The inputs in shiny are defined with a function that will correspond to the type of information we want the user to provide. For example, if we want to introduce a categorical variable, we call use the function <code>selectInput()</code>; If we want a numeric variable, we can use <code>sliderInput()</code> or <code>numericInput()</code>. Since all the input functions in the shiny library contains the word <em>Input</em>, we can use the autocomplete function in R to search what options we have for different type of inputs:</p>
<p><img src="img/Ia_01-Inputs.GIF" style="width:60%" align="center"></p>
<p>Similarly, the outputs in Shiny has to be specified according to the type of outputs we want to include. For example, there are different functions to specify if we want to output a plot (<code>plotOutput()</code>), a table(<code>tableOutput</code>), or other types we will see later.</p>
<pre class="r"><code># Define the UI
ui &lt;- fluidPage(
  # Panel for the app title
  titlePanel(&quot;Lab 1&quot;),
  # side panel 
  sidebarPanel(
    # Inputs for region
    selectInput(inputId = &quot;Mun&quot;, # Unique ID for our input
                label = &quot;Municipios:&quot;, # Label to describe the input
                choices = unique(vac$NOM_MUN), # Define the choices
                multiple = T, # allow selection of multiple choices
                selected = unique(vac$NOM_MUN)) # Initial selection
  ),
  # Output panels
  mainPanel(
    plotOutput(&quot;VacMun&quot;) # Time series figure
  )
)</code></pre>
</div>
<div id="server" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Server</h1>
<p>The server must include all the processes that our app will execute.</p>
<pre class="r"><code># Define server logic required to draw a histogram
server &lt;- function(input, output) {
  # We will create a reactive object (listens to changes in the UI)
  x &lt;- reactive({
    p &lt;- vac %&gt;% # This is our data
      filter(NOM_MUN %in% input$Mun) # Filter the observations that matches the input
  })
  
  # Then we will create out plot
  output$VacMun &lt;- renderPlot({
    x() %&gt;%  # This is our reactive object
      group_by(YEAR) %&gt;%  # We group by year
      summarise(Vac = sum(VAC_BOV)) %&gt;%  # get the sum of Vaccinated
      ggplot(aes(x = YEAR, y=Vac)) + # Call ggplot2
      geom_bar(position=&quot;dodge&quot;, stat=&quot;identity&quot;, fill = &quot;deepskyblue4&quot;) + # add a bar layer
      # add labels for our plot
      labs(x = &quot;Year&quot;, y = &quot;Vaccine doses applied&quot;, 
           title = &quot;Application of rabies vaccine&quot;)
  })
}</code></pre>
</div>
<div id="running-the-app" class="section level1" number="4">
<h1><span class="header-section-number">4</span> Running the app</h1>
<p>In the previous lab, we used the <em>Run App</em> button to start the app, what this button does is just send the code to the console, so we can manually run the app by just running the code.</p>
<pre class="r"><code># integrate the app components
shinyApp(ui = ui, server = server)</code></pre>
<hr />
</div>
<div id="excercise" class="section level1" number="5">
<h1><span class="header-section-number">5</span> Excercise</h1>
<p>The STNet library contains 2 other data sets we will be using in thus workshop, to access them you can use:</p>
<pre class="r"><code>data(&quot;vigilancia&quot;)
data(&quot;captura&quot;)</code></pre>
<p>Examine one of the data sets and think what other types of plots we can make? what other inputs do you think we could integrate? we can discuss this in the group.</p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
